import{_ as P,V}from"./BgMq0hds.js";import{_ as k}from"./BTZhcGdv.js";import{r as c,e as S,c as i,a as o,h as p,t as f,i as x,b as d,w,n as g,ap as U,o as m,d as A}from"./C3f4aPB-.js";import{S as _,F as E,a as C,h as I}from"./CcP0DOW9.js";import{u as L}from"./CppIkSQx.js";import{g as z,a as B}from"./DDxaSBBi.js";import"./o7ON5bpy.js";import"./CMuC9vtR.js";import"./CUORWU_8.js";var D={};const N={class:"flex justify-center items-center min-h-screen p-4"},R={class:"bg-white p-6 rounded-lg shadow-lg w-full h-full max-w-sm"},M={key:0,class:"bg-red-500 text-white text-sm p-2 mb-4 rounded"},T={class:"mb-4"},$={key:0,class:"text-red-500 text-sm mt-1"},j={class:"mb-6 relative"},F={key:0,class:"text-red-500 text-sm mt-1"},O={key:0,class:"text-red-500 text-sm mt-1"},se={__name:"index",setup(q){const v=c(""),s=c({}),h=U(),n=c({username:"",password:""}),u=c(!1),y=async()=>{s.value={};const a=_.fire({title:"Logging in...",text:"Please wait while we authenticate you.",allowOutsideClick:!1,didOpen:()=>{_.showLoading()}});try{const e=E(n.value),t=await C.post(`${V}login`,e);if(t.data&&t.data.token){const{token:l,user:r}=t.data;console.log(t.data),L().setAuthData(l,r),a.close(),await b(l),h.push("/admin/dashboard/")}}catch(e){a.close(),e.response&&e.response.data&&e.response.data.errors?s.value=e.response.data.errors:I(e)}},b=async a=>{try{await z(a),await B(a)}catch(e){console.error("Error in preprocessing:",e),_.fire({icon:"error",title:"Preprocessing failed",text:"There was an issue fetching permissions or roles. Please try again."})}};return S(()=>{console.log(D.VITE_APP_API_URL)}),(a,e)=>{const t=P,l=k;return m(),i("div",N,[o("div",R,[e[6]||(e[6]=o("h1",{class:"text-3xl font-semibold text-center text-emerald-900 mb-6"}," Condo Management System ",-1)),v.value?(m(),i("div",M,f(v.value),1)):p("",!0),o("form",{onSubmit:x(y,["prevent"])},[o("div",T,[e[3]||(e[3]=o("label",{for:"username",class:"block text-sm font-medium text-emerald-900 mb-2"},"Username",-1)),d(l,{modelValue:n.value.username,"onUpdate:modelValue":e[0]||(e[0]=r=>n.value.username=r),size:"md",placeholder:"Enter your username",class:g({"border-red-500":s.value.username})},{trailing:w(()=>[d(t,{color:"gray",variant:"link",icon:"i-heroicons-user",padded:!1})]),_:1},8,["modelValue","class"]),s.value.username?(m(),i("p",$,f(s.value.username[0]),1)):p("",!0)]),o("div",j,[e[4]||(e[4]=o("label",{for:"password",class:"block text-sm font-medium text-emerald-900 mb-2"},"Password",-1)),d(l,{type:u.value?"text":"password",modelValue:n.value.password,"onUpdate:modelValue":e[2]||(e[2]=r=>n.value.password=r),size:"md",ui:{icon:{trailing:{pointer:""}}},placeholder:"Enter your password",class:g({"border-red-500":s.value.password})},{trailing:w(()=>[d(t,{color:"gray",icon:u.value?"i-heroicons-eye-slash":"i-heroicons-eye",padded:!1,onClick:e[1]||(e[1]=x(r=>u.value=!u.value,["prevent"]))},null,8,["icon"])]),_:1},8,["type","modelValue","class"]),s.value.password?(m(),i("p",F,f(s.value.password[0]),1)):p("",!0)]),d(t,{color:"yellow",type:"submit",width:"w-full",size:"md",class:"flex w-full items-center justify-center",variant:"solid"},{default:w(()=>e[5]||(e[5]=[A(" Login ")])),_:1}),s.value.message?(m(),i("p",O,f(s.value.message[0]),1)):p("",!0)],32)])])}}};export{se as default};
